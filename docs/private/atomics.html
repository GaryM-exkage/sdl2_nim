<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--  This file is generated by Nim. -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Favicon -->
<link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
<link rel="icon" type="image/png" sizes="32x32" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH4QQQEwksSS9ZWwAAAk1JREFUWMPtll2ITVEUx39nn/O7Y5qR8f05wtCUUr6ZIS++8pEnkZInPImneaCQ5METNdOkeFBKUhMPRIkHKfEuUZSUlGlKPN2TrgfncpvmnntnmlEyq1Z7t89/rf9a6+y99oZxGZf/XeIq61EdtgKXgdXA0xrYAvBjOIF1AI9zvjcC74BSpndrJPkBWDScTF8Aa4E3wDlgHbASaANmVqlcCnwHvgDvgVfAJ+AikAAvgfVZwLnSVZHZaOuKoQi3ZOMi4NkYkpe1p4J7A8BpYAD49hfIy/oqG0+hLomiKP2L5L+1ubn5115S+3OAn4EnwBlgMzCjyt6ZAnQCJ4A7wOs88iRJHvw50HoujuPBoCKwHWiosy8MdfZnAdcHk8dxXFJ3VQbQlCTJvRBCGdRbD4M6uc5glpY3eAihpN5S5w12diSEcCCEcKUO4ljdr15T76ur1FDDLIQQ3qv71EdDOe3Kxj3leRXyk+pxdWnFWod6Wt2bY3de3aSuUHcPBVimHs7mK9WrmeOF6lR1o9qnzskh2ar2qm1qizpfXaPeVGdlmGN5pb09qMxz1Xb1kLqgzn1RyH7JUXW52lr5e/Kqi9qpto7V1atuUzfnARrV7jEib1T76gG2qxdGmXyiekkt1GswPTtek0aBfJp6YySGBfWg2tPQ0FAYgf1stUfdmdcjarbYJEniKIq6gY/Aw+zWHAC+p2labGpqiorFYgGYCEzN7oQdQClN07O1/EfDyGgC0ALMBdYAi4FyK+4H3gLPsxfR1zRNi+NP7nH5J+QntnXe5B5mpfQAAAAASUVORK5CYII=">

<!-- Google fonts -->
<link href='https://fonts.googleapis.com/css?family=Lato:400,600,900' rel='stylesheet' type='text/css'/>
<link href='https://fonts.googleapis.com/css?family=Source+Code+Pro:400,500,600' rel='stylesheet' type='text/css'/>

<!-- CSS -->
<title>atomics</title>
<link rel="stylesheet" type="text/css" href="nimdoc.out.css">

<script type="text/javascript" src="dochack.js"></script>

<script type="text/javascript">
function main() {
  var pragmaDots = document.getElementsByClassName("pragmadots");
  for (var i = 0; i < pragmaDots.length; i++) {
    pragmaDots[i].onclick = function(event) {
      // Hide tease
      event.target.parentNode.style.display = "none";
      // Show actual
      event.target.parentNode.nextElementSibling.style.display = "inline";
    }
  }

  const toggleSwitch = document.querySelector('.theme-switch input[type="checkbox"]');
  function switchTheme(e) {
      if (e.target.checked) {
          document.documentElement.setAttribute('data-theme', 'dark');
          localStorage.setItem('theme', 'dark');
      } else {
          document.documentElement.setAttribute('data-theme', 'light');
          localStorage.setItem('theme', 'light');
      }
  }

  toggleSwitch.addEventListener('change', switchTheme, false);

  const currentTheme = localStorage.getItem('theme') ? localStorage.getItem('theme') : null;
  if (currentTheme) {
    document.documentElement.setAttribute('data-theme', currentTheme);

    if (currentTheme === 'dark') {
      toggleSwitch.checked = true;
    }
  }
}

window.addEventListener('DOMContentLoaded', main);
</script>

</head>
<body>
<div class="document" id="documentId">
  <div class="container">
    <h1 class="title">atomics</h1>
    <div class="row">
  <div class="three columns">
  <div class="theme-switch-wrapper">
    <label class="theme-switch" for="checkbox">
      <input type="checkbox" id="checkbox" />
      <div class="slider round"></div>
    </label>
    &nbsp;&nbsp;&nbsp; <em>Dark Mode</em>
  </div>
  <div id="global-links">
    <ul class="simple">
    <li>
      <a href="../index.html">Index</a>
    </li>
    </ul>
  </div>
  <div id="searchInputDiv">
    Search: <input type="text" id="searchInput"
      onkeyup="search()" />
  </div>
  <div>
    Group by:
    <select onchange="groupBy(this.value)">
      <option value="section">Section</option>
      <option value="type">Type</option>
    </select>
  </div>
  <ul class="simple simple-toc" id="toc-list">
<li><a class="reference" id="atomicsdotnim_toc" href="#atomicsdotnim">atomics.nim</a></li>
<ul class="simple"><li><a class="reference" id="atomicsdotnim-importantcolon_toc" href="#atomicsdotnim-importantcolon">IMPORTANT:</a></li>
</ul><li><a class="reference" id="atomiclock_toc" href="#atomiclock">AtomicLock</a></li>
<li>
  <a class="reference reference-toplevel" href="#7" id="57">Types</a>
  <ul class="simple simple-toc-section">
      <li><a class="reference" href="#SpinLock"
    title="SpinLock* = cint">SpinLock</a></li>
  <li><a class="reference" href="#Atomic_t"
    title="Atomic_t* = object
  value*: cint">Atomic_t</a></li>

  </ul>
</li>
<li>
  <a class="reference reference-toplevel" href="#12" id="62">Procs</a>
  <ul class="simple simple-toc-section">
      <li><a class="reference" href="#atomicTryLock%2Cptr.SpinLock"
    title="atomicTryLock*(lock: ptr SpinLock): bool">atomicTryLock</a></li>
  <li><a class="reference" href="#atomicLock%2Cptr.SpinLock"
    title="atomicLock*(lock: ptr SpinLock)">atomicLock</a></li>
  <li><a class="reference" href="#atomicUnlock%2Cptr.SpinLock"
    title="atomicUnlock*(lock: ptr SpinLock)">atomicUnlock</a></li>
  <li><a class="reference" href="#atomicCAS%2Cptr.Atomic_t%2Ccint%2Ccint"
    title="atomicCAS*(a: ptr Atomic_t; oldval: cint; newval: cint): bool">atomicCAS</a></li>
  <li><a class="reference" href="#atomicSet%2Cptr.Atomic_t%2Ccint"
    title="atomicSet*(a: ptr Atomic_t; v: cint): cint">atomicSet</a></li>
  <li><a class="reference" href="#atomicGet%2Cptr.Atomic_t"
    title="atomicGet*(a: ptr Atomic_t): cint">atomicGet</a></li>
  <li><a class="reference" href="#atomicAdd%2Cptr.Atomic_t%2Ccint"
    title="atomicAdd*(a: ptr Atomic_t; v: cint): cint">atomicAdd</a></li>
  <li><a class="reference" href="#atomicCASPtr%2Cptr.pointer%2Cpointer%2Cpointer"
    title="atomicCASPtr*(a: ptr pointer; oldval: pointer; newval: pointer): bool">atomicCASPtr</a></li>
  <li><a class="reference" href="#atomicSetPtr%2Cptr.pointer%2Cpointer"
    title="atomicSetPtr*(a: ptr pointer; v: pointer): pointer">atomicSetPtr</a></li>
  <li><a class="reference" href="#atomicGetPtr%2Cptr.pointer"
    title="atomicGetPtr*(a: ptr pointer): pointer">atomicGetPtr</a></li>

  </ul>
</li>
<li>
  <a class="reference reference-toplevel" href="#18" id="68">Templates</a>
  <ul class="simple simple-toc-section">
      <li><a class="reference" href="#atomicIncRef.t%2Cuntyped"
    title="atomicIncRef*(a: untyped): untyped">atomicIncRef</a></li>
  <li><a class="reference" href="#atomicDecRef.t%2Cuntyped"
    title="atomicDecRef*(a: untyped): untyped">atomicDecRef</a></li>

  </ul>
</li>

</ul>

  </div>
  
  <div class="nine columns" id="content">
  <div id="tocRoot"></div>
  
  <p class="module-desc">
<h1><a class="toc-backref" id="atomicsdotnim" href="#atomicsdotnim">atomics.nim</a></h1><p>Atomic operations.</p>

<h2><a class="toc-backref" id="atomicsdotnim-importantcolon" href="#atomicsdotnim-importantcolon">IMPORTANT:</a></h2><p>If you are not an expert in concurrent lockless programming, you should only be using the atomic lock and reference counting procedures in this file.  In all other cases you should be protecting your data structures with full mutexes.</p>
<p>The list of &quot;safe&quot; procedures to use are:</p>
<ul class="simple"><li><tt class="docutils literal"><span class="pre">atomicLock()</span></tt></li>
<li><tt class="docutils literal"><span class="pre">atomicUnlock()</span></tt></li>
<li><tt class="docutils literal"><span class="pre">atomicIncRef()</span></tt></li>
<li><tt class="docutils literal"><span class="pre">atomicDecRef()</span></tt></li>
</ul>
<p><tt class="docutils literal"><span class="pre">Seriously, here be dragons!</span></tt></p>
<p>You can find out a little more about lockless programming and the subtle issues that can arise here:</p>
<p><a class="reference external" href="http://msdn.microsoft.com/en-us/library/ee418650%28v=vs.85%29.aspx">http://msdn.microsoft.com/en-us/library/ee418650%28v=vs.85%29.aspx</a></p>
<p>There's also lots of good information here:</p>
<p><a class="reference external" href="http://www.1024cores.net/home/lock-free-algorithms">http://www.1024cores.net/home/lock-free-algorithms</a></p>
<p><a class="reference external" href="http://preshing.com">http://preshing.com</a></p>
<p>These operations may or may not actually be implemented using processor specific atomic operations. When possible they are implemented as true processor specific atomic operations. When that is not possible the are implemented using locks that <em>do</em> use the available atomic operations.</p>
<p>All of the atomic operations that modify memory are full memory barriers.</p>

<h1><a class="toc-backref" id="atomiclock" href="#atomiclock">AtomicLock</a></h1><p>The atomic locks are efficient spinlocks using CPU instructions, but are vulnerable to starvation and can spin forever if a thread holding a lock has been terminated.  For this reason you should minimize the code executed inside an atomic lock and never do expensive things like API or system calls while holding them.</p>
<p>The atomic locks are not safe to lock recursively.</p>
<p><tt class="docutils literal"><span class="pre">Porting Note:</span></tt> The spin lock procedures and type are required and can not be emulated because they are used in the atomic emulation code.</p>
</p>
  <div class="section" id="7">
<h1><a class="toc-backref" href="#7">Types</a></h1>
<dl class="item">
<a id="SpinLock"></a>
<dt><pre><span class="Identifier">SpinLock</span><span class="Operator">*</span> <span class="Other">=</span> <span class="Identifier">cint</span></pre></dt>
<dd>



</dd>
<a id="Atomic_t"></a>
<dt><pre><span class="Identifier">Atomic_t</span><span class="Operator">*</span> <span class="Other">=</span> <span class="Keyword">object</span>
  <span class="Identifier">value</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">cint</span>
</pre></dt>
<dd>


A type representing an atomic integer value.  It is a object so people don't accidentally use numeric operations on it.

</dd>

</dl></div>
<div class="section" id="12">
<h1><a class="toc-backref" href="#12">Procs</a></h1>
<dl class="item">
<a id="atomicTryLock,ptr.SpinLock"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#atomicTryLock%2Cptr.SpinLock"><span class="Identifier">atomicTryLock</span></a><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">lock</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">SpinLock</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">cdecl</span><span class="Other">,</span>
    <span class="Identifier">importc</span><span class="Other">:</span> <span class="StringLit">&quot;SDL_AtomicTryLock&quot;</span><span class="Other">,</span> <span class="Identifier">dynlib</span><span class="Other">:</span> <span class="Identifier">SDL2_LIB</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Try to lock a spin lock by setting it to a non-zero value.</p>
<p><tt class="docutils literal"><span class="pre">lock</span></tt> Points to the lock.</p>
<p><tt class="docutils literal"><span class="pre">Return</span></tt> <tt class="docutils literal"><span class="pre">true</span></tt> if the lock succeeded, <tt class="docutils literal"><span class="pre">false</span></tt> if the lock is already held.</p>


</dd>
<a id="atomicLock,ptr.SpinLock"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#atomicLock%2Cptr.SpinLock"><span class="Identifier">atomicLock</span></a><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">lock</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">SpinLock</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">cdecl</span><span class="Other">,</span> <span class="Identifier">importc</span><span class="Other">:</span> <span class="StringLit">&quot;SDL_AtomicLock&quot;</span><span class="Other">,</span>
                                       <span class="Identifier">dynlib</span><span class="Other">:</span> <span class="Identifier">SDL2_LIB</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Lock a spin lock by setting it to a non-zero value.</p>
<p><tt class="docutils literal"><span class="pre">lock</span></tt> Points to the lock.</p>


</dd>
<a id="atomicUnlock,ptr.SpinLock"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#atomicUnlock%2Cptr.SpinLock"><span class="Identifier">atomicUnlock</span></a><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">lock</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">SpinLock</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">cdecl</span><span class="Other">,</span> <span class="Identifier">importc</span><span class="Other">:</span> <span class="StringLit">&quot;SDL_AtomicUnlock&quot;</span><span class="Other">,</span>
    <span class="Identifier">dynlib</span><span class="Other">:</span> <span class="Identifier">SDL2_LIB</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Unlock a spin lock by setting it to <tt class="docutils literal"><span class="pre">0</span></tt>. Always returns immediately.</p>
<p><tt class="docutils literal"><span class="pre">lock</span></tt> Points to the lock.</p>


</dd>
<a id="atomicCAS,ptr.Atomic_t,cint,cint"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#atomicCAS%2Cptr.Atomic_t%2Ccint%2Ccint"><span class="Identifier">atomicCAS</span></a><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">a</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">Atomic_t</span><span class="Other">;</span> <span class="Identifier">oldval</span><span class="Other">:</span> <span class="Identifier">cint</span><span class="Other">;</span> <span class="Identifier">newval</span><span class="Other">:</span> <span class="Identifier">cint</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">cdecl</span><span class="Other">,</span>
    <span class="Identifier">importc</span><span class="Other">:</span> <span class="StringLit">&quot;SDL_AtomicCAS&quot;</span><span class="Other">,</span> <span class="Identifier">dynlib</span><span class="Other">:</span> <span class="Identifier">SDL2_LIB</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Set an atomic variable to a new value if it is currently an old value.</p>
<p><tt class="docutils literal"><span class="pre">Return</span></tt> <tt class="docutils literal"><span class="pre">true</span></tt> if the atomic variable was set, <tt class="docutils literal"><span class="pre">false</span></tt> otherwise.</p>
<p><tt class="docutils literal"><span class="pre">Note</span></tt> If you don't know what this procedure is for, you shouldn't use it!</p>


</dd>
<a id="atomicSet,ptr.Atomic_t,cint"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#atomicSet%2Cptr.Atomic_t%2Ccint"><span class="Identifier">atomicSet</span></a><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">a</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">Atomic_t</span><span class="Other">;</span> <span class="Identifier">v</span><span class="Other">:</span> <span class="Identifier">cint</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">cint</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">cdecl</span><span class="Other">,</span>
    <span class="Identifier">importc</span><span class="Other">:</span> <span class="StringLit">&quot;SDL_AtomicSet&quot;</span><span class="Other">,</span> <span class="Identifier">dynlib</span><span class="Other">:</span> <span class="Identifier">SDL2_LIB</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Set an atomic variable to a value.</p>
<p><tt class="docutils literal"><span class="pre">Return</span></tt> The previous value of the atomic variable.</p>


</dd>
<a id="atomicGet,ptr.Atomic_t"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#atomicGet%2Cptr.Atomic_t"><span class="Identifier">atomicGet</span></a><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">a</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">Atomic_t</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">cint</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">cdecl</span><span class="Other">,</span> <span class="Identifier">importc</span><span class="Other">:</span> <span class="StringLit">&quot;SDL_AtomicGet&quot;</span><span class="Other">,</span>
    <span class="Identifier">dynlib</span><span class="Other">:</span> <span class="Identifier">SDL2_LIB</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Get the value of an atomic variable

</dd>
<a id="atomicAdd,ptr.Atomic_t,cint"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#atomicAdd%2Cptr.Atomic_t%2Ccint"><span class="Identifier">atomicAdd</span></a><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">a</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">Atomic_t</span><span class="Other">;</span> <span class="Identifier">v</span><span class="Other">:</span> <span class="Identifier">cint</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">cint</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">cdecl</span><span class="Other">,</span>
    <span class="Identifier">importc</span><span class="Other">:</span> <span class="StringLit">&quot;SDL_AtomicAdd&quot;</span><span class="Other">,</span> <span class="Identifier">dynlib</span><span class="Other">:</span> <span class="Identifier">SDL2_LIB</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Add to an atomic variable.</p>
<p><tt class="docutils literal"><span class="pre">Return</span></tt> The previous value of the atomic variable.</p>
<p><tt class="docutils literal"><span class="pre">Note</span></tt> This same style can be used for any number operation.</p>


</dd>
<a id="atomicCASPtr,ptr.pointer,pointer,pointer"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#atomicCASPtr%2Cptr.pointer%2Cpointer%2Cpointer"><span class="Identifier">atomicCASPtr</span></a><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">a</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">pointer</span><span class="Other">;</span> <span class="Identifier">oldval</span><span class="Other">:</span> <span class="Identifier">pointer</span><span class="Other">;</span> <span class="Identifier">newval</span><span class="Other">:</span> <span class="Identifier">pointer</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma">
    <span class="Identifier">cdecl</span><span class="Other">,</span> <span class="Identifier">importc</span><span class="Other">:</span> <span class="StringLit">&quot;SDL_AtomicCASPtr&quot;</span><span class="Other">,</span> <span class="Identifier">dynlib</span><span class="Other">:</span> <span class="Identifier">SDL2_LIB</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Set a pointer to a new value if it is currently an old value.</p>
<p><tt class="docutils literal"><span class="pre">Return</span></tt> <tt class="docutils literal"><span class="pre">true</span></tt> if the pointer was set, <tt class="docutils literal"><span class="pre">false</span></tt> otherwise.</p>
<p><tt class="docutils literal"><span class="pre">Note</span></tt> If you don't know what this procedure is for, you shouldn't use it!</p>


</dd>
<a id="atomicSetPtr,ptr.pointer,pointer"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#atomicSetPtr%2Cptr.pointer%2Cpointer"><span class="Identifier">atomicSetPtr</span></a><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">a</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">pointer</span><span class="Other">;</span> <span class="Identifier">v</span><span class="Other">:</span> <span class="Identifier">pointer</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">pointer</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">cdecl</span><span class="Other">,</span>
    <span class="Identifier">importc</span><span class="Other">:</span> <span class="StringLit">&quot;SDL_AtomicSetPtr&quot;</span><span class="Other">,</span> <span class="Identifier">dynlib</span><span class="Other">:</span> <span class="Identifier">SDL2_LIB</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Set a pointer to a value atomically.</p>
<p><tt class="docutils literal"><span class="pre">Return</span></tt> The previous value of the pointer.</p>


</dd>
<a id="atomicGetPtr,ptr.pointer"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#atomicGetPtr%2Cptr.pointer"><span class="Identifier">atomicGetPtr</span></a><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">a</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">pointer</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">pointer</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">cdecl</span><span class="Other">,</span>
    <span class="Identifier">importc</span><span class="Other">:</span> <span class="StringLit">&quot;SDL_AtomicGetPtr&quot;</span><span class="Other">,</span> <span class="Identifier">dynlib</span><span class="Other">:</span> <span class="Identifier">SDL2_LIB</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Get the value of a pointer atomically.

</dd>

</dl></div>
<div class="section" id="18">
<h1><a class="toc-backref" href="#18">Templates</a></h1>
<dl class="item">
<a id="atomicIncRef.t,untyped"></a>
<dt><pre><span class="Keyword">template</span> <a href="#atomicIncRef.t%2Cuntyped"><span class="Identifier">atomicIncRef</span></a><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">a</span><span class="Other">:</span> <span class="Identifier">untyped</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">untyped</span></pre></dt>
<dd>


Increment an atomic variable used as a reference count.

</dd>
<a id="atomicDecRef.t,untyped"></a>
<dt><pre><span class="Keyword">template</span> <a href="#atomicDecRef.t%2Cuntyped"><span class="Identifier">atomicDecRef</span></a><span class="Operator">*</span><span class="Other">(</span><span class="Identifier">a</span><span class="Other">:</span> <span class="Identifier">untyped</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">untyped</span></pre></dt>
<dd>

<p>
Decrement an atomic variable used as a reference count.</p>
<p><tt class="docutils literal"><span class="pre">Return</span></tt> <tt class="docutils literal"><span class="pre">true</span></tt> if the variable reached zero after decrementing, <tt class="docutils literal"><span class="pre">false</span></tt> otherwise.</p>


</dd>

</dl></div>

  </div>
</div>

    <div class="row">
      <div class="twelve-columns footer">
        <span class="nim-sprite"></span>
        <br/>
        <small style="color: var(--hint);">Made with Nim. Generated: 2020-12-27 16:44:21 UTC</small>
      </div>
    </div>
  </div>
</div>

</body>
</html>
